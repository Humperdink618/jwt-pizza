# Incident: 2025-11-26 10-37-55

## Summary

Between the hours of **10:37 AM** and **11:16 AM MST** on **2025-11-26**, **all users** encountered problems with purchasing pizzas from the Pizza Factory, resulting in multiple pizza purchase failures. The event was triggered by a **chaos test** inside the JWT Pizza Factory at **17:36 UTC**. The chaos test was initiated in the JWT Pizza Factory the previous day at 02:57 UTC, and activated chaos injected code inside of the service, which effectively overrode the logic that handled the purchasing of pizzas from the factory when activated.

A bug in this code caused **all pizza purchase attempts to fail**. The event was detected by the **JWT Pizza DevOps team**, when the system monitoring the website detected a sudden increase in the number of purchase failures. The team started working on the event by analyzing the frontend response code and manually testing the pizza purchase functionality while looking for errors. They eventually discovered a hidden URL inside the error response code, which led to a separate page and triggered the chaos test to stop, resolving the issue. This **SEV-1** incident affected **100%** of users.

Aside from a few minor latency issues (which quickly resolved themselves), no further impact was detected.

## Detection

This incident was detected when the **Pizza Purchases alert** was triggered and the **JWT Pizza DevOps team members** were paged. The initial response was a little slow, so the team was sent a push notification a minute later, which the team then quickly responded and acknowledged the alert. Due to the nature of the incident, the number of purchase failures dropped back to zero before the issue could be fully resolved, causing the alert to prematurely resolve itself. 

The alert triggered again two minutes later, and once again the JWT Pizza DevOps team was paged. This time, however, the response was prompt and quickly acknowledged, so no push notifications were sent. Just as with the first incident, the number of purchase failures dropped back to zero again, and the alert once more resolved itself prematurely. This pattern would continue within two minute intervals of one another, until the last alert was triggered at 18:13 UTC, which was promptly acknowledged within a matter of seconds of receiving the alert.

Due to these recurring alerts and premature resolutions, the actual resolution was delayed for roughly 45 minutes.

The **chaos injection code inside the service will be disabled** by the **JWT Pizza DevOps team** in order to prevent further incidents like this. Additionally, a **few minor adjustments to the Pizza Purchase metrics and alert systems** will be set up by the **JWT Pizza DevOps team** so that the alerts persist for longer and do not resolve themselves prematurely before the actual issue is fully resolved.

## Impact

For **45 minutes** between **17:36 UTC and 18:16 UTC** on **11/26/2025**, our users experienced an abnormal amount of pizza purchase failures.

This incident affected **all customers** (100% of **JWT Pizza dashboard users, including diners, franchisees, and admins**), who experienced failures in their pizza purchases. The JWT Pizza company also experienced a large drop in revenue due to the lack of successful pizza purchases, causing some potential financial loss. Details regarding the actual estimated financial loss for the company are still pending, and will be released soon. Due to the sudden decrease in revenue during the incident, it is safe to assume that no customer transactions were finalized, and that no customer lost any money as a result of the incident. However, just to be safe, we are also conducting an investigation into that matter as well. Details are still pending. 

**36 support tickets** and **312 sarcastic tweets** were submitted, mostly consisting of comments dubbing the incident "PizzaGate" and goofy meme images captioned "The Pizza is a Lie."

## Timeline

All times are UTC.

- _02:57_ - Chaos test initiated on JWT Pizza Factory. Chaos injection code had been implemented sometime prior that day at an unknown time.
- _17:36_ - Chaos test activated. Minor unrelated latency issues had been detected, acknowledged within a timely manner, and resolved moments prior to the event.
- _17:37_ - On-Call reports a problem to the JWT Pizza DevOps team by SMS
- _17:39_ - First SMS message receives no response, so On-Call sends another alert to the JWT Pizza DevOps team via mobile push. The team responds and acknowledges the alert.
- _17:40_ - JWT Pizza DevOps starts investigating logs and metrics reporting the pizza purchase failures. Metrics data noted, but nothing found initially in the logs. JWT Pizza DevOps then starts investigating the frontend code and network settings on the JWT Pizza website. Nothing found initially.
- _17:42_ - Number of pizza purchase failures suddenly drops back down to zero. Initial alert automatically resolves itself before JWT Pizza DevOps team could properly investigate the issue and resolve it themselves. JWT Pizza DevOps team never got the opportunity to actually officially declare an incident.
- _17:43_ - On-Call once again reports a problem to the JWT Pizza DevOps team by SMS regarding pizza purchase failures.
- _17:44_ - JWT Pizza DevOps team responds to SMS notification and begins investigating the metrics and frontend code and network settings. This time, they have suspicions that a greater incident is occurring. However, just as before, they fail to officially declare an incident.
- _17:48_ - Once again, the number of failed pizza purchases drops back to zero and alert resolves itself prematurely. No official incident declared. JWT Pizza DevOps team continues to investigate the incident.
- _17:49_ - On-Call once again reports a problem to the JWT Pizza DevOps team by SMS regarding pizza purchase failures.
- _17:50_ - JWT Pizza DevOps team again responds to SMS notification and acknowledges the alert. They continue to investigate the metrics and frontend. By this point, the JWT Pizza DevOps team have long figured out the nature of the incident and recognize it at such. However, despite this, they yet again forget to officially declare it as an incident.
- _17:54_ - Once more, the number of failed pizza purchases drops back to zero and alert resolves itself prematurely. No official incident declared. JWT Pizza DevOps team continues to investigate the incident.
- _17:55_ - On-Call once again reports a problem to the JWT Pizza DevOps team by SMS regarding pizza purchase failures. Team responds to the notification.
- _17:56_ - JWT Pizza DevOps team again acknowledges the alert. They continue to investigate the metrics and frontend, but yet again forget to officially declare an incident.
- _17:59_ - Yet again, the number of failed pizza purchases drops back to zero and alert resolves itself prematurely. No official incident declared. JWT Pizza DevOps team continues to investigate the incident.
- _18:00_ - On-Call once more reports a problem to the JWT Pizza DevOps team by SMS regarding pizza purchase failures. 
- _18:01_ - JWT Pizza DevOps team again receives the notification and acknowledges the alert. They continue to investigate the frontend network, console, and source components code, but again find nothing. Yet again, they forget to officially declare an incident.
- _18:04_ - Once more, the number of failed pizza purchases drops back to zero and alert resolves itself prematurely. No official incident declared. JWT Pizza DevOps team continues to investigate the incident.
- _18:05_ - On-Call yet again reports a problem to the JWT Pizza DevOps team by SMS regarding pizza purchase failures. 
- _18:06_ - JWT Pizza DevOps team again acknowledges the alert. They continue to investigate the frontend network, but once again fail to officially declare an incident. JWT Pizza DevOps team suddenly realizes that they forgot to refresh the network logs on the frontend devOps panel and they refresh it. No issues found initially. Team begins to investigate the requests, but still find nothing.
- _18:10_ - Yet again, the number of failed pizza purchases drops back to zero and alert resolves itself prematurely. No official incident declared. JWT Pizza DevOps team continues to investigate the incident.
- _18:12_ - On-Call triggers an alert one last time regarding pizza purchase failures.
- _18:13_ - On-Call reports the problem one last time to the JWT Pizza DevOps team by SMS regarding pizza purchase failures. They respond and acknowledge the alert. Once more, they forget to officially declare an incident (upper management should really have a serious talk with them about that!)
- _18:14_ - JWT Pizza DevOps team finally decides to manually test the frontend functionality for purchasing pizzas. They finally discover the problem: a couple response calls on the orderRouter's POST method for placing a pizza order are throwing 500 internal server errors. The JWT Pizza DevOps team begins investigating the request headers, payloads, responses, and previews for the root problem.  
- _18:15_ - JWT Pizza DevOps team finally discovers a hidden url inside of the request's response preview messages. Meanwhile, the number of pizza purchase failures drops down to zero one last time, and once more, the alert auto-resolves itself. However, this time, the JWT Pizza DevOps team is confident that they found the source of the problem. However, they still forget to officially declare the incident. 
- _18:16_ - JWT Pizza DevOps team copies the URL from the error message and searches it in the browser. A notification appears that states that the problem is resolved and that pizza is back on the menu. JWT Pizza Factory confirms that the issue has been resolved, and after manually testing the frontend pizza purchase functionality one last time, the team confirms that the issue is resolved and that no further pizza purchase failures have occurred. Since the alert had already resolved itself a minute prior, the team decided to consider that final resolution as their official declaration that the incident had been resolved. No official incident declaration was ever made by the team. 
- _12:20_ - While writing the incident report, the JWT Pizza DevOps team finally notices the button that says "Declare Incident" on the Grafana IRM Alert groups dashboard, and suddenly feel immensely stupid about their massive oversight (nervous laughter). They also finally notice the bright blue glowing button that says "Unresolve" on that same dashboard, meaning that they also could've prevented the premature alert resolutions a long time ago without ever realizing it. Now they feel even more stupid, and they begin to pray that upper management will be merciful to them regarding this massive oversight.

## Response

After receiving a page at **17:39 UTC**, **on-call DevOps engineer (Anton)** came online at **17:39 UTC** in the Grafana IRM Alert groups page.

This engineer quickly recognized what was going on, and quickly responded to the incident. He was the engineer on-call for all the alerts that were made reporting on the incident.

## Root cause

A couple lines of chaos injection code within the service had been remotely activated by an external source, which then overrode the service router's PUSH request method for handling pizza purchase logic to instead return an error message with a URL link leading to an external website inside of it. Upon activation, no further pizza purchases could be made.

## Resolution

The team ultimately resolved the issue by manually testing the frontend pizza purchase functionality and analyzing the requests and responses in the network for errors or suspicious code. They eventually discovered the hidden URL inside the error message, and upon copying and pasting the URL into the browser's search bar, they discovered the web page that the URL led to. Upon accessing the web page, the site triggered a command in the JWT Pizza Factory, which terminated the chaos test and resolved the issue. One additional manual pizza purchase test was performed by the team on the frontend code to verify if the issue had indeed been resolved, which it had.

Mitigation time could've been improved if the team had just tried to manually purchase a pizza in the first place, instead of just blindly searching around for network requests that hadn't even been made yet. Mitigation time could've been further improved had the team just utilized the "unresolve" button to only have to process one alert as opposed to multiple ones. Upper management is currently talking to the JWT Pizza DevOps team regarding these oversights.

## Prevention

This same root cause could occur anywhere where similar chaos code could be injected. This incident also demonstrates that the backend code for the JWT Pizza website could be accessed by third party sources, exposing a critical security breach. 

## Action items

1. Don't initiate chaos!
2. Comment out or remove the chaos injection code.
3. Perform routine checks and tests on the JWT Pizza Factory to ensure that it actually returns the pizza purchase orders without issues
4. If an incident like this or any other kind of incident occurs, and alerts continue to fire and resolve themselves in a cyclic pattern without actually resolving the underlying incident, see to it that the JWT Pizza DevOps team understands that they can always unresolve the incident if they feel as if the incident hasn't actually been fully resolved.
5. See to it that the JWT Pizza DevOps team actually remembers to officially declare an incident when they recognize it as such!
6. Implement additional security measures to see to it that the backend code is only accessible to admins and that proper security measures are put in place to prevent potential code injection from overriding key functionality (or worse)